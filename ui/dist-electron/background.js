"use strict";const{app:t,BrowserWindow:l,Tray:d,Menu:p,nativeImage:h,globalShortcut:w}=require("electron"),{join:a,dirname:g}=require("path"),{spawn:m}=require("child_process");let n,i;process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";const s=()=>{const r=h.createFromPath(a(__dirname,"logo.png")),e=new l({width:1200,useContentSize:!0,height:600,icon:r,autoHideMenuBar:!0,minWidth:1200,minHeight:600,webPreferences:{webSecurity:!1,nodeIntegration:!0,enableRemoteModule:!0,contextIsolation:!1}});w.register("Control+Alt+Space",()=>{e.show()}),n=new d(r);const c=p.buildFromTemplate([{label:"主界面",click:()=>e.show()},{label:"退出",click:()=>t.exit()}]);if(n.on("double-click",()=>{e.show()}),n.setToolTip("快寻,快速寻找你想要的"),n.setContextMenu(c),e.on("close",o=>{e.hide(),e.setSkipTaskbar(!0),o.preventDefault()}),process.env.VITE_DEV_SERVER_URL)e.loadURL(process.env.VITE_DEV_SERVER_URL);else{const o=t.getAppPath();process.chdir(o+"/../../"),i=m("quickSearch.exe"),e.loadFile(a(__dirname,"../dist/index.html"))}};t.on("certificate-error",(r,e,c,o,f,u)=>{log("certificate-error"),r.preventDefault(),u(!0)});t.commandLine.appendSwitch("ignore-certificate-errors");t.whenReady().then(()=>{s(),t.on("activate",()=>{l.getAllWindows().length===0&&s()})});t.on("window-all-closed",()=>{try{i&&process.kill(i.pid)}catch{}process.platform!=="darwin"&&t.quit()});
